{"ast":null,"code":"import _toConsumableArray from\"/Users/milantornier/Desktop/MySite/milansblog/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/milantornier/Desktop/MySite/milansblog/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/milantornier/Desktop/MySite/milansblog/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4;import{useState,useEffect}from'react';import CommentItem from'./CommentItem';import CommentForm from'./CommentForm';import{retrieveComments}from'../../service/WPService';import styled,{css}from'styled-components';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CommentSection=styled.section(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    margin-bottom:1.5em;\\n\"])));var Button=styled.button(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    margin-left:4em;\\n    align-self:flex-end;\\n    border: none;\\n    background-color: transparent;\\n    color: var(--s-7);\\n    max-width:8em;\\n\"])));var Container=styled.section(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n    display:flex;\\n    flex-direction:column;\\n    \",\"\\n\"])),function(props){return props.depth===1&&css(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n        margin-left: 2em;\\n    \"])));});export default function Comments(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),comments=_useState2[0],setComments=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loaded=_useState4[0],setLoaded=_useState4[1];var _useState5=useState(props.post),_useState6=_slicedToArray(_useState5,1),id=_useState6[0];var _useState7=useState(props.parent),_useState8=_slicedToArray(_useState7,1),parent=_useState8[0];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),hideForm=_useState10[0],setHideForm=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),hideReplies=_useState12[0],setHideReplies=_useState12[1];var _useState13=useState('show replies'),_useState14=_slicedToArray(_useState13,2),showRepliesText=_useState14[0],setShowRepliesText=_useState14[1];var _useState15=useState('reply'),_useState16=_slicedToArray(_useState15,2),replyText=_useState16[0],setReplytext=_useState16[1];var _useState17=useState(props.depth),_useState18=_slicedToArray(_useState17,1),depth=_useState18[0];useEffect(function(){console.log('retrieve');retrieveComments(id,parent).then(function(res){return setComments(res);},setLoaded(true));return function cleanup(){setLoaded(false);};},[id,parent]);var showReplies=function showReplies(currently){setHideReplies(!currently);if(hideReplies){setShowRepliesText('show replies');}else{setShowRepliesText('hide replies');}};var showForm=function showForm(currently){setHideForm(!currently);if(hideForm){setReplytext('reply');}else{setReplytext('cancel');}};var _updateComments=function updateComments(newComment){showReplies(false);if(newComment===null){return;}setComments(function(comments){return[newComment].concat(_toConsumableArray(comments));});};if(loaded){return/*#__PURE__*/_jsx(CommentSection,{children:/*#__PURE__*/_jsxs(Container,{depth:depth,children:[depth===1&&/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return showForm(hideForm);},children:replyText}),(depth===0||hideForm)&&/*#__PURE__*/_jsx(CommentForm,{updateComments:function updateComments(x){return _updateComments(x);},post:id,parent:parent},'commentForm'+{parent:parent}),depth===1&&/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return showReplies(hideReplies);},children:showRepliesText}),(depth===0||hideReplies)&&comments.map(function(comment){return/*#__PURE__*/_jsx(CommentItem,{depth:depth+1,comment:comment},comment.id);})]})});}else{return'loading...';}}","map":{"version":3,"sources":["/Users/milantornier/Desktop/MySite/milansblog/src/components/Comments/Comments.js"],"names":["useState","useEffect","CommentItem","CommentForm","retrieveComments","styled","css","CommentSection","section","Button","button","Container","props","depth","Comments","comments","setComments","loaded","setLoaded","post","id","parent","hideForm","setHideForm","hideReplies","setHideReplies","showRepliesText","setShowRepliesText","replyText","setReplytext","console","log","then","res","cleanup","showReplies","currently","showForm","updateComments","newComment","x","map","comment"],"mappings":"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","sourcesContent":["import {useState, useEffect} from 'react'\nimport CommentItem from './CommentItem'\nimport CommentForm from './CommentForm'\nimport {retrieveComments} from '../../service/WPService'\nimport styled, {css} from 'styled-components'\n\nconst CommentSection = styled.section`\n    margin-bottom:1.5em;\n`\n\nconst Button = styled.button`\n    margin-left:4em;\n    align-self:flex-end;\n    border: none;\n    background-color: transparent;\n    color: var(--s-7);\n    max-width:8em;\n`\n\nconst Container = styled.section`\n    display:flex;\n    flex-direction:column;\n    ${props => props.depth === 1 && css`\n        margin-left: 2em;\n    `}\n`\n\nexport default function Comments(props) {\n\n    const [comments, setComments] = useState([])\n    const [loaded, setLoaded] = useState(false)\n    const [id]  = useState(props.post)\n    const [parent] = useState(props.parent)\n\n    const [hideForm, setHideForm] = useState(false);\n    const [hideReplies, setHideReplies] = useState(false);\n\n    const [showRepliesText, setShowRepliesText] = useState('show replies')\n    const [replyText, setReplytext] = useState('reply')\n\n    const [depth] = useState(props.depth)\n    \n    useEffect( () => {\n\n        console.log('retrieve')\n        retrieveComments(id, parent).then( res =>\n            setComments(res),\n            setLoaded(true),\n        )\n\n        return function cleanup() {\n            setLoaded(false);\n        }\n\n    }, [id, parent])\n\n    const showReplies = (currently) => {\n        setHideReplies(!currently);\n        if(hideReplies){\n            setShowRepliesText('show replies')\n        } else {\n            setShowRepliesText('hide replies')\n        }\n    }\n\n    const showForm = (currently) => {\n        setHideForm(!currently);\n        if(hideForm){\n            setReplytext('reply')\n        } else {\n            setReplytext('cancel')\n        }\n    }\n\n    const updateComments = (newComment) => {\n        showReplies(false);\n        if(newComment === null){\n            return;\n        }\n        setComments(comments => [newComment, ...comments])\n    }\n\n        if(loaded){\n            return (\n                <CommentSection>\n                    <Container depth={depth}>\n                        {depth===1 && <Button onClick={() => showForm(hideForm)}>{replyText}</Button>}\n                        {(depth===0||hideForm) && \n                            <CommentForm\n                                updateComments = {x => updateComments(x)} \n                                post={id}\n                                parent={parent} \n                                key={'commentForm'+{parent}} \n                            />\n                        }\n                        {depth===1 && <Button onClick={() => showReplies(hideReplies)}>{showRepliesText}</Button> }\n                        {(depth===0||hideReplies) && comments.map(comment => (\n                            <CommentItem \n                                depth={depth+1}\n                                key={comment.id} \n                                comment={comment}\n                            />\n                        ))}\n                    </Container>\n                </CommentSection>\n            )\n        } else {\n            return 'loading...'\n        }\n}\n\n"]},"metadata":{},"sourceType":"module"}